CREATE TABLE USERS(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
USER VARCHAR(20) NOT NULL,
NOME VARCHAR(20) NOT NULL,
COGNOME VARCHAR(20) NOT NULL,
SESSO VARCHAR(1) NOT NULL,
EMAIL VARCHAR(20) NOT NULL
) ENGINE = 'INNODB';

CREATE TABLE DEVICES(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
ID_USER INT,
MODELLO VARCHAR(20) NOT NULL,
MAC VARCHAR(20) NOT NULL,
STATO BOOL NOT NULL,
TIPO VARCHAR(20) NOT NULL,
INDEX NEW_ID_USER (ID_USER),
FOREIGN KEY(ID_USER) REFERENCES USERS(ID) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE = 'INNODB';

CREATE TABLE ADMIN(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY
) ENGINE = 'INNODB';

CREATE TABLE MEDICO(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY
) ENGINE = 'INNODB';

CREATE TABLE UM(
ID_USER INT NOT NULL,
ID_MEDICO INT NOT NULL,
PRIMARY KEY (ID_USER,ID_MEDICO),
INDEX NEW_ID_USER(ID_USER),
INDEX NEW_ID_MEDICO(ID_MEDICO),
FOREIGN KEY(ID_USER) REFERENCES USERS(ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ID_MEDICO) REFERENCES MEDICO(ID) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE = 'INNODB';

CREATE TABLE UA(
ID_USER INT NOT NULL,
ID_ADMIN INT NOT NULL,
PRIMARY KEY (ID_USER,ID_ADMIN),
INDEX NEW_ID_USER(ID_USER),
INDEX NEW_ID_ADMIN(ID_ADMIN),
FOREIGN KEY(ID_USER) REFERENCES USERS(ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ID_ADMIN) REFERENCES ADMIN(ID) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE = 'INNODB';

CREATE TABLE CARTA_DI_CREDITO(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
NUMERO_CARTA VARCHAR(16) NOT NULL,
DATA DATE NOT NULL,
CVV VARCHAR(3)
) ENGINE = 'INNODB';

CREATE TABLE PIANO_CLINICO(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
PATH_FILE VARCHAR(500) NOT NULL
) ENGINE = 'INNODB';

CREATE TABLE PAZIENTE(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
ID_CARTA_CREDITO INT NOT NULL,
ID_PIANO_CLINICO INT NOT NULL,
INDEX NEW_ID_CARTA_CREDITO(ID_CARTA_CREDITO),
INDEX NEW_ID_PIANO_CLINICO(ID_PIANO_CLINICO),
FOREIGN KEY(ID_CARTA_CREDITO) REFERENCES CARTA_DI_CREDITO(ID) ON UPDATE CASCADE,
FOREIGN KEY(ID_PIANO_CLINICO) REFERENCES PIANO_CLINICO(ID) ON UPDATE CASCADE
) ENGINE = 'INNODB';

CREATE TABLE UP(
ID_USER INT NOT NULL,
ID_PAZIENTE INT NOT NULL,
PRIMARY KEY (ID_USER,ID_PAZIENTE),
INDEX NEW_ID_USER(ID_USER),
INDEX NEW_ID_PAZIENTE(ID_PAZIENTE),
FOREIGN KEY(ID_USER) REFERENCES USERS(ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ID_PAZIENTE) REFERENCES PAZIENTE(ID) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE = 'INNODB';

CREATE TABLE MEDICINALE(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
NOME VARCHAR(20),
DATA DATE NOT NULL,
QUANTITA INT NOT NULL
) ENGINE = 'INNODB';

CREATE TABLE PM(
ID_PAZIENTE INT NOT NULL,
ID_MEDICINALE INT NOT NULL,
PRIMARY KEY (ID_PAZIENTE,ID_MEDICINALE),
INDEX NEW_ID_PAZIENTE(ID_PAZIENTE),
INDEX NEW_ID_MEDICINALE(ID_MEDICINALE),
FOREIGN KEY(ID_PAZIENTE) REFERENCES PAZIENTE(ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ID_MEDICINALE) REFERENCES MEDICINALE(ID) ON UPDATE CASCADE 
) ENGINE = 'INNODB';

CREATE TABLE FILE_LOG(
ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
DATA DATE NOT NULL,
BPM INT NOT NULL,
P_MIN INT NOT NULL,
P_MAX INT NOT NULL,
TEMP FLOAT NOT NULL
) ENGINE = 'INNODB';

CREATE TABLE PL(
ID_PAZIENTE INT NOT NULL,
ID_FILE_LOG INT NOT NULL,
PRIMARY KEY (ID_PAZIENTE,ID_FILE_LOG),
INDEX NEW_ID_PAZIENTE(ID_PAZIENTE),
INDEX NEW_ID_FILE_LOG(ID_FILE_LOG),
FOREIGN KEY(ID_PAZIENTE) REFERENCES PAZIENTE(ID) ON UPDATE CASCADE,
FOREIGN KEY(ID_FILE_LOG) REFERENCES FILE_LOG(ID) ON UPDATE CASCADE
) ENGINE = 'INNODB';
